(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{514:function(a,t,s){"use strict";s.r(t);var e=s(6),n=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"è°ƒè¯•å…¥é—¨å·¥å…·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è°ƒè¯•å…¥é—¨å·¥å…·"}},[a._v("#")]),a._v(" è°ƒè¯•å…¥é—¨å·¥å…·")]),a._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"}),s("p",[a._v("JDK è‡ªå¸¦çš„å·¥å…·ï¼Œéƒ½ä½äº JDK çš„ bin ç›®å½•")])]),s("h3",{attrs:{id:"jps-è¿›ç¨‹ç›‘æ§å·¥å…·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jps-è¿›ç¨‹ç›‘æ§å·¥å…·"}},[a._v("#")]),a._v(" jpsï¼šè¿›ç¨‹ç›‘æ§å·¥å…·")]),a._v(" "),s("p",[a._v("è¯¥å‘½ä»¤å¾ˆåƒ UNIX çš„ ps å‘½ä»¤ï¼Œåˆ—å‡ºå½“å‰ç”¨æˆ·æ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœºè¿›ç¨‹ï¼Œå¹¶æ˜¾ç¤ºè™šæ‹Ÿæœºæ‰§è¡Œä¸»ç±»ï¼ˆMain Classï¼Œmain() å‡½æ•°æ‰€åœ¨çš„ç±»ï¼‰åç§°ä»¥åŠè¿™äº›è¿›ç¨‹çš„æœ¬åœ°è™šæ‹Ÿæœºå”¯ä¸€ IDï¼ˆLVMIDï¼ŒLocal Virtual Machine Identifierï¼‰ã€‚")]),a._v(" "),s("p",[a._v("jps å‘½ä»¤æ ¼å¼ï¼š")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("jps [options] [hostid]\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("jps å·¥å…·çš„ä¸»è¦é€‰é¡¹ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("-qï¼šåªè¾“å‡º LVMIDï¼Œä¸è¾“å‡ºç±»åç§°ã€Jar åç§°å’Œä¼ å…¥ main æ–¹æ³•çš„å‚æ•°ï¼›")]),a._v(" "),s("li",[a._v("-lï¼šè¾“å‡º main ç±»æˆ– Jar çš„ å…¨é™å®šåç§°ï¼›")]),a._v(" "),s("li",[a._v("-mï¼šè¾“å‡ºä¼ å…¥ main æ–¹æ³•çš„å‚æ•°ï¼›")]),a._v(" "),s("li",[a._v("-vï¼šè¾“å‡ºè™šæ‹Ÿæœºè¿›ç¨‹å¯åŠ¨æ—¶ä¼ å…¥çš„ JVM å‚æ•°")])]),a._v(" "),s("p",[a._v("æŸ¥çœ‹æ›´å¤šä½¿ç”¨æ–¹æ³•ï¼š"),s("a",{attrs:{href:"https://docs.oracle.com/javase/8/docs/technotes/tools/windows/jps.html#CHDCGECD",target:"_blank",rel:"noopener noreferrer"}},[a._v("Oracle jps"),s("OutboundLink")],1)]),a._v(" "),s("h3",{attrs:{id:"jstat-ç»Ÿè®¡ä¿¡æ¯ç›‘æ§å·¥å…·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jstat-ç»Ÿè®¡ä¿¡æ¯ç›‘æ§å·¥å…·"}},[a._v("#")]),a._v(" jstatï¼šç»Ÿè®¡ä¿¡æ¯ç›‘æ§å·¥å…·")]),a._v(" "),s("p",[a._v("jstatï¼ˆJVM Statistics Monitoring Toolï¼‰ æ˜¯ç”¨äºè¯†åˆ«è™šæ‹Ÿæœºå„ç§è¿è¡ŒçŠ¶æ€ä¿¡æ¯çš„å‘½ä»¤è¡Œå·¥å…·ã€‚å®ƒå¯ä»¥æ˜¾ç¤ºæœ¬åœ°æˆ–è€…è¿œç¨‹è™šæ‹Ÿæœºè¿›ç¨‹ä¸­çš„ç±»è£…è½½ã€å†…å­˜ã€åƒåœ¾æ”¶é›†ã€jit ç¼–è¯‘ç­‰è¿è¡Œæ—¶æ•°æ®ã€‚")]),a._v(" "),s("p",[a._v("jstat å‘½ä»¤æ ¼å¼ï¼š")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("jstat -<option> [-t] [-h<lines>] <vmid> [<interval> [<count>]]\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("optionï¼šå‚æ•°é€‰é¡¹")]),a._v(" "),s("li",[a._v("-tï¼šå¯ä»¥åœ¨æ‰“å°çš„åˆ—åŠ ä¸Š timestamp åˆ—ï¼Œç”¨äºæ˜¾ç¤ºç³»ç»Ÿè¿è¡Œçš„æ—¶é—´")]),a._v(" "),s("li",[a._v("-hï¼šå¯ä»¥åœ¨å‘¨æœŸæ€§æ•°æ®çš„æ—¶å€™ï¼Œå¯ä»¥åœ¨æŒ‡å®šè¾“å‡ºå¤šå°‘è¡Œä»¥åè¾“å‡ºä¸€æ¬¡è¡¨å¤´")]),a._v(" "),s("li",[a._v("vmidï¼šè¿›ç¨‹ID")]),a._v(" "),s("li",[a._v("linesï¼šè¡¨å¤´ä¸è¡¨å¤´çš„é—´éš”è¡Œæ•°")]),a._v(" "),s("li",[a._v("intervalï¼šæ‰§è¡Œæ¯æ¬¡çš„é—´éš”æ—¶é—´ï¼Œå•ä½ä¸º"),s("strong",[a._v("æ¯«ç§’")])]),a._v(" "),s("li",[a._v("countï¼šç”¨äºæŒ‡å®šè¾“å‡ºè®°å½•çš„æ¬¡æ•°ï¼Œç¼ºçœåˆ™ä¼šä¸€ç›´æ‰“å°")])]),a._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"}),s("p",[a._v("æƒ³äº†è§£ option æœ‰å“ªäº›ï¼Œå¯ä»¥æ‰§è¡Œ "),s("code",[a._v("jstat -options")])]),a._v(" "),s("ul",[s("li",[a._v("-classï¼šæ˜¾ç¤ºç±»åŠ è½½ ClassLoad çš„ç›¸å…³ä¿¡æ¯ï¼›")]),a._v(" "),s("li",[a._v("-compiler:ï¼šæ˜¾ç¤º JIT ç¼–è¯‘çš„ç›¸å…³ä¿¡æ¯ï¼›")]),a._v(" "),s("li",[a._v("-gcï¼šæ˜¾ç¤ºå’Œ gcç›¸å…³çš„å †ä¿¡æ¯ï¼›")]),a._v(" "),s("li",[a._v("-gccapacityï¼šæ˜¾ç¤ºå„ä¸ªä»£çš„å®¹é‡ä»¥åŠä½¿ç”¨æƒ…å†µï¼›")]),a._v(" "),s("li",[a._v("-gcmetacapacityï¼šæ˜¾ç¤ºå…ƒç©ºé—´ metaspace çš„å¤§å°ï¼›")]),a._v(" "),s("li",[a._v("-gcnewï¼šæ˜¾ç¤ºæ–°ç”Ÿä»£ä¿¡æ¯ï¼›")]),a._v(" "),s("li",[a._v("-gcnewcapacity: æ˜¾ç¤ºæ–°ç”Ÿä»£å¤§å°å’Œä½¿ç”¨æƒ…å†µï¼›")]),a._v(" "),s("li",[a._v("-gcoldï¼šæ˜¾ç¤ºè€å¹´ä»£åƒåœ¾æ”¶é›†çŠ¶å†µï¼›")]),a._v(" "),s("li",[a._v("-gcoldcapacityï¼šæ˜¾ç¤ºè€å¹´ä»£çš„å¤§å°ï¼›")]),a._v(" "),s("li",[a._v("-gcutilï¼šæ˜¾ç¤ºåƒåœ¾å›æ”¶ä¿¡æ¯ï¼›")]),a._v(" "),s("li",[a._v("-gccauseï¼šæ˜¾ç¤ºåƒåœ¾å›æ”¶çš„ç›¸å…³ä¿¡æ¯ï¼ˆåŒ -gcutilï¼‰ï¼ŒåŒæ—¶æ˜¾ç¤ºæœ€åä¸€æ¬¡æˆ–å½“å‰æ­£åœ¨å‘ç”Ÿçš„åƒåœ¾å›æ”¶çš„åŸå› ï¼›")]),a._v(" "),s("li",[a._v("-printcompilationï¼šè¾“å‡º JIT ç¼–è¯‘çš„æ–¹æ³•ä¿¡æ¯")])])]),s("details",{staticClass:"custom-block details"},[s("summary",[a._v("See More")]),a._v(" "),s("p",[a._v("ä½¿ç”¨ "),s("code",[a._v("-gc")]),a._v(" æŸ¥çœ‹æ—¶ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("S0ï¼ŒS1è¡¨ç¤ºæ–°ç”Ÿä»£ä¸¤ä¸ª Survivor åŒºï¼ŒE ä»£è¡¨çš„æ˜¯æ–°ç”Ÿä»£çš„ Eden åŒº")]),a._v(" "),s("li",[a._v("C çš„æ„æ€æ˜¯å®¹é‡ï¼ŒU è¡¨ç¤ºå·²ç»ä½¿ç”¨çš„æ„æ€")]),a._v(" "),s("li",[a._v("O è¡¨ç¤ºçš„è€å¹´ä»£")]),a._v(" "),s("li",[a._v("M è¡¨ç¤º Metaspaceã€‚")]),a._v(" "),s("li",[a._v("F å’Œ Y åˆ™è¡¨ç¤º fullGC å’Œ minorGC")]),a._v(" "),s("li",[a._v("GCT è¡¨ç¤º GC Time")]),a._v(" "),s("li",[a._v("YGCã€YGCTï¼šYoungGC çš„æ¬¡æ•°ä¸æ—¶é—´")]),a._v(" "),s("li",[a._v("FGCã€FGCTï¼šFullGC çš„æ¬¡æ•°ä¸æ—¶é—´")])])]),a._v(" "),s("p",[a._v("æŸ¥çœ‹æ›´å¤šä½¿ç”¨æ–¹æ³•ï¼š"),s("a",{attrs:{href:"https://docs.oracle.com/javase/8/docs/technotes/tools/windows/jstat.html#BEHHGFAE",target:"_blank",rel:"noopener noreferrer"}},[a._v("Oracle jstat"),s("OutboundLink")],1)]),a._v(" "),s("h3",{attrs:{id:"jinfo-é…ç½®ä¿¡æ¯å·¥å…·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jinfo-é…ç½®ä¿¡æ¯å·¥å…·"}},[a._v("#")]),a._v(" jinfoï¼šé…ç½®ä¿¡æ¯å·¥å…·")]),a._v(" "),s("p",[a._v("jinfoï¼ˆConfiguration Info for Javaï¼‰çš„ä½œç”¨æ˜¯å®æ—¶åœ°æŸ¥çœ‹å’Œè°ƒæ•´è™šæ‹Ÿæœºå„é¡¹å‚æ•°ï¼Œä½¿ç”¨ jps å‘½ä»¤çš„ -v å‚æ•°å¯ä»¥æŸ¥çœ‹è™šæ‹Ÿæœºå¯åŠ¨æ—¶"),s("strong",[a._v("æ˜¾å¼æŒ‡å®š")]),a._v("çš„å‚æ•°åˆ—è¡¨ã€‚ä½†å¦‚æœæƒ³çŸ¥é“"),s("strong",[a._v("æœªè¢«æ˜¾å¼æŒ‡å®š")]),a._v("çš„å‚æ•°çš„ç³»ç»Ÿé»˜è®¤å€¼ï¼Œé™¤äº†å»æ‰¾èµ„æ–™å¤–ï¼Œå°±åªèƒ½ä½¿ç”¨ jinfo çš„ -flag é€‰é¡¹è¿›è¡ŒæŸ¥è¯¢ã€‚")]),a._v(" "),s("p",[a._v("jinfo å‘½ä»¤æ ¼å¼ï¼š")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("jinfo [-options] <pid>\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("no optionï¼šè¾“å‡ºå…¨éƒ¨çš„å‚æ•°å’Œç³»ç»Ÿå±æ€§")]),a._v(" "),s("li",[a._v("-flag nameï¼šè¾“å‡ºå¯¹åº”åç§°çš„å‚æ•°")]),a._v(" "),s("li",[a._v("-flag [+|-]nameï¼šå¼€å¯æˆ–è€…å…³é—­å¯¹åº”åç§°çš„å‚æ•°")])]),a._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"}),s("p",[s("strong",[a._v("é€šè¿‡ jinfo å®æ—¶çš„ä¿®æ”¹è™šæ‹Ÿæœºçš„å‚æ•°")])]),a._v(" "),s("p",[a._v("ä½†æ˜¯ä¸æ˜¯ä»»ä½•å‘½ä»¤éƒ½å¯ä»¥ä¿®æ”¹ï¼Œå¯ä»¥ä¿®æ”¹çš„å‚æ•°æˆ‘ä»¬å…ˆæ¥æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼š"),s("code",[a._v("java -XX:+PrintFlagsFinal -version")]),a._v("ï¼Œä¼šåˆ—å‡ºå½“å‰æœºå™¨æ”¯æŒçš„æ‰€æœ‰å‚æ•°ï¼Œé‚£ä¹ˆç”¨ jinfo å¯ä»¥ä¿®æ”¹çš„å‚æ•°æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿåªæœ‰æœ€åä¸€åˆ—æ˜¾ç¤º "),s("code",[a._v("manageable")]),a._v(" çš„è¿™ä¸€åˆ—æ‰èƒ½è¿›è¡Œä¿®æ”¹")])]),s("p",[a._v("æŸ¥çœ‹æ›´å¤šä½¿ç”¨æ–¹æ³•ï¼š"),s("a",{attrs:{href:"https://docs.oracle.com/javase/8/docs/technotes/tools/windows/jinfo.html#BCGEBFDD",target:"_blank",rel:"noopener noreferrer"}},[a._v("Oracle jinfo"),s("OutboundLink")],1)]),a._v(" "),s("h3",{attrs:{id:"jmap-å†…å­˜æ˜ åƒå·¥å…·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jmap-å†…å­˜æ˜ åƒå·¥å…·"}},[a._v("#")]),a._v(" jmapï¼šå†…å­˜æ˜ åƒå·¥å…·")]),a._v(" "),s("p",[a._v("ç”¨äºç”Ÿæˆå †è½¬å‚¨å¿«ç…§ï¼ˆä¸€èˆ¬ç§°ä¸º heapdump æˆ– dump æ–‡ä»¶ï¼‰ã€‚å¦‚æœä¸ä½¿ç”¨jmap å‘½ä»¤ï¼Œè¦æƒ³è·å– Java å †è½¬å‚¨å¿«ç…§ï¼Œè¿˜æœ‰ä¸€äº›æ¯”è¾ƒâ€œæš´åŠ›â€çš„æ‰‹æ®µï¼šè­¬å¦‚ "),s("code",[a._v("-XX : + HeapDumpOnOutOfMemoryError")]),a._v(" å‚æ•°ï¼Œå¯ä»¥è®©è™šæ‹Ÿæœºåœ¨ OOM å¼‚å¸¸å‡ºç°ä¹‹åè‡ªåŠ¨ç”Ÿæˆ dump æ–‡ä»¶ï¼Œé€šè¿‡ "),s("code",[a._v("-XX : +HeapDumpOnCtrlBreak")]),a._v(" å‚æ•°åˆ™å¯ä»¥ä½¿ç”¨ "),s("code",[a._v("[Ctrl]+[Break]")]),a._v(" é”®è®©è™šæ‹Ÿæœºç”Ÿæˆ dump æ–‡ä»¶ï¼Œåˆæˆ–è€…åœ¨ Linux ç³»ç»Ÿä¸‹é€šè¿‡ Kill-3 å‘½ä»¤å‘é€è¿›ç¨‹é€€å‡ºä¿¡å·â€œå“å”¬â€ä¸€ä¸‹è™šæ‹Ÿæœºï¼Œä¹Ÿèƒ½æ‹¿åˆ° dump æ–‡ä»¶ã€‚")]),a._v(" "),s("p",[a._v("jmap çš„ä½œç”¨å¹¶ä¸ä»…ä»…æ˜¯ä¸ºäº†è·å– dump æ–‡ä»¶ï¼Œä»–è¿˜å¯ä»¥æŸ¥è¯¢ finalize æ‰§è¡Œé˜Ÿåˆ—ã€Java å †å’Œæ–¹æ³•åŒºçš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚ç©ºé—´ä½¿ç”¨ç‡ã€å½“å‰ç”¨çš„æ˜¯å“ªç§æ”¶é›†å™¨ç­‰ã€‚")]),a._v(" "),s("p",[a._v("å’Œ jinfo å‘½ä»¤ä¸€æ ·ï¼Œjmap æœ‰ä¸å°‘åŠŸèƒ½åœ¨ Windows å¹³å°ä¸‹éƒ½æ˜¯å—é™çš„ï¼Œé™¤äº†ç”Ÿæˆ dump æ–‡ä»¶çš„ -dump é€‰é¡¹å’Œç”¨äºæŸ¥çœ‹æ¯ä¸ªç±»çš„å®ä¾‹ã€ç©ºé—´å ç”¨ç»Ÿè®¡çš„ -histo é€‰é¡¹åœ¨æ‰€æœ‰æ“ä½œç³»ç»Ÿéƒ½æä¾›ä¹‹å¤–ï¼Œå…¶ä½™é€‰é¡¹éƒ½åªèƒ½åœ¨ Linux/Solarisä¸‹ä½¿ç”¨ã€‚")]),a._v(" "),s("p",[a._v("jmap å‘½ä»¤æ ¼å¼ï¼š")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("jmap [-options]  vmid\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("dumpï¼šç”ŸæˆJavaå †è½¬å‚¨å¿«ç…§ã€‚æ ¼å¼ä¸ºï¼š"),s("code",[a._v("-dump:[live, ]format=b, file=<filename>")]),a._v("ï¼Œå…¶ä¸­ live å­å‚æ•°è¯´æ˜æ˜¯å¦åª dump å‡ºå­˜æ´»çš„å¯¹è±¡")]),a._v(" "),s("li",[a._v("-finalizerinfoï¼šæ˜¾ç¤ºåœ¨ F-Queue ä¸­ç­‰å¾… Finalizer çº¿ç¨‹æ‰§è¡Œ finalize æ–¹æ³•çš„å¯¹è±¡ã€‚åªåœ¨ Linux/Solaris å¹³å°ä¸‹æœ‰æ•ˆ")]),a._v(" "),s("li",[a._v("-heapï¼šæ˜¾ç¤º Java å †è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚ä½¿ç”¨å“ªç§å›æ”¶å™¨ã€å‚æ•°é…ç½®ã€åˆ†ä»£çŠ¶å†µç­‰ã€‚åªåœ¨ Linux/Solaris å¹³å°ä¸‹æœ‰æ•ˆ")]),a._v(" "),s("li",[a._v("-histoï¼šæ˜¾ç¤ºå †ä¸­å¯¹è±¡ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»ã€å®ä¾‹æ•°é‡ã€åˆè®¡å®¹é‡")]),a._v(" "),s("li",[a._v("-permstatï¼šä»¥ ClassLoader ä¸ºç»Ÿè®¡å£å¾„æ˜¾ç¤ºæ°¸ä¹…ä»£å†…å­˜çŠ¶æ€ã€‚åªåœ¨ Linux/Solaris å¹³å°ä¸‹æœ‰æ•ˆ")]),a._v(" "),s("li",[a._v("-Fï¼šå½“è™šæ‹Ÿæœºè¿›ç¨‹å¯¹ -dump é€‰é¡¹æ²¡æœ‰å“åº”æ—¶ï¼Œå¯ä½¿ç”¨è¿™ä¸ªé€‰é¡¹å¼ºåˆ¶ç”Ÿæˆ dump å¿«ç…§ã€‚åªåœ¨ Linux/Solaris å¹³å°ä¸‹æœ‰æ•ˆ")])]),a._v(" "),s("p",[a._v("ğŸŒ°")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("# æŸ¥çœ‹å †çš„æƒ…å†µ\njmap -heap 2815\n\n# dump\njmap -dump:live,format=b,file=/tmp/heap2.bin 2815\njmap -dump:format=b,file=/tmp/heap3.bin 2815\n\n# æŸ¥çœ‹å †çš„å ç”¨\njmap -histo 2815 | head -10\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("p",[a._v("æŸ¥çœ‹æ›´å¤šï¼š"),s("a",{attrs:{href:"https://www.jianshu.com/p/a4ad53179df3",target:"_blank",rel:"noopener noreferrer"}},[a._v("JVM æ€§èƒ½è°ƒä¼˜å·¥å…· jmap"),s("OutboundLink")],1)]),a._v(" "),s("h3",{attrs:{id:"jhat-å †è½¬å‚¨å¿«ç…§åˆ†æå·¥å…·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jhat-å †è½¬å‚¨å¿«ç…§åˆ†æå·¥å…·"}},[a._v("#")]),a._v(" jhatï¼šå †è½¬å‚¨å¿«ç…§åˆ†æå·¥å…·")]),a._v(" "),s("p",[a._v("jhatï¼ˆJVM Heap Analysis Toolï¼‰å‘½ä»¤ä¸ jmap æ­é…ä½¿ç”¨ï¼Œæ¥åˆ†æ jmap ç”Ÿæˆçš„å †è½¬å‚¨å¿«ç…§ã€‚jhat å†…ç½®äº†ä¸€ä¸ªå¾®å‹çš„ HTTP/HTML æœåŠ¡å™¨ï¼Œç”Ÿæˆ dump æ–‡ä»¶çš„åˆ†æç»“æœåï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹ã€‚")]),a._v(" "),s("p",[a._v("ä¸è¿‡å®äº‹æ±‚æ˜¯åœ°è¯´ï¼Œåœ¨å®é™…å·¥ä½œä¸­ï¼Œé™¤éæ‰‹ä¸ŠçœŸçš„æ²¡æœ‰åˆ«çš„å·¥å…·å¯ç”¨ï¼Œå¦åˆ™ä¸€èˆ¬éƒ½ä¸ä¼šå»ç›´æ¥ä½¿ç”¨ jhat å‘½ä»¤æ¥åˆ†æ dump æ–‡ä»¶ï¼Œä¸»è¦åŸå› æœ‰ä¸¤ä¸ªï¼š")]),a._v(" "),s("ul",[s("li",[a._v("ä¸€èˆ¬ä¸ä¼šåœ¨éƒ¨ç½²åº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ä¸Šç›´æ¥åˆ†æ dump æ–‡ä»¶ï¼Œå³ä½¿å¯ä»¥è¿™æ ·åšï¼Œä¹Ÿä¼šå°½é‡å°† dump æ–‡ä»¶å¤åˆ¶åˆ°å…¶ä»–æœºå™¨ã€‚åˆ†æå·¥ä½œæ˜¯ä¸€ä¸ªè€—æ—¶è€Œä¸”æ¶ˆè€—ç¡¬ä»¶èµ„æºçš„è¿‡ç¨‹ï¼Œæ—¢ç„¶éƒ½è¦åœ¨å…¶ä»–æœºå™¨è¿›è¡Œï¼Œå°±æ²¡æœ‰å¿…è¦å—åˆ°å‘½ä»¤è¡Œå·¥å…·çš„é™åˆ¶äº†ï¼›")]),a._v(" "),s("li",[a._v("jhat çš„åˆ†æåŠŸèƒ½ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€é™‹ï¼ŒVisualVM ä»¥åŠä¸“ä¸šç”¨äºåˆ†æ dump æ–‡ä»¶çš„ Eclipse Memory Analyzerã€IBM HeapAnalyzer ç­‰å·¥å…·ï¼Œéƒ½èƒ½å®ç°æ¯” jhat æ›´å¼ºå¤§æ›´ä¸“ä¸šçš„åˆ†æåŠŸèƒ½")])]),a._v(" "),s("h3",{attrs:{id:"jstack-çº¿ç¨‹å †æ ˆåˆ†æå·¥å…·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jstack-çº¿ç¨‹å †æ ˆåˆ†æå·¥å…·"}},[a._v("#")]),a._v(" jstackï¼šçº¿ç¨‹å †æ ˆåˆ†æå·¥å…·")]),a._v(" "),s("p",[a._v("jstack ç”¨äºç”Ÿæˆè™šæ‹Ÿæœºå½“å‰æ—¶åˆ»çš„çº¿ç¨‹å¿«ç…§ã€‚çº¿ç¨‹å¿«ç…§æ˜¯å½“å‰è™šæ‹Ÿæœºå†…æ¯ä¸€æ¡çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•å †æ ˆçš„é›†åˆï¼Œç”Ÿæˆçº¿ç¨‹å¿«ç…§çš„"),s("strong",[a._v("ä¸»è¦ç›®çš„æ˜¯å®šä½çº¿ç¨‹å‡ºç°é•¿æ—¶é—´åœé¡¿çš„åŸå› ï¼Œå¦‚çº¿ç¨‹é—´æ­»é”ã€æ­»å¾ªç¯ã€è¯·æ±‚å¤–éƒ¨èµ„æºå¯¼è‡´çš„é•¿æ—¶é—´ç­‰å¾…ç­‰")]),a._v("ã€‚ çº¿ç¨‹å‡ºç°åœé¡¿çš„æ—¶å€™é€šè¿‡ jstack æ¥æŸ¥çœ‹å„ä¸ªçº¿ç¨‹çš„è°ƒç”¨å †æ ˆï¼Œå°±å¯ä»¥çŸ¥é“æ²¡æœ‰å“åº”çš„çº¿ç¨‹åˆ°åº•åœ¨åå°åšä»€ä¹ˆäº‹æƒ…ï¼Œæˆ–è€…ç­‰å¾…ä»€ä¹ˆèµ„æºã€‚")]),a._v(" "),s("p",[a._v("jstack å‘½ä»¤æ ¼å¼ï¼š")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("jstack [-options] vmid\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("-Fï¼šå½“æ­£å¸¸è¾“å‡ºè¯·æ±‚ä¸è¢«å“åº”æ—¶ï¼Œå¼ºåˆ¶è¾“å‡ºçº¿ç¨‹å †æ ˆ")]),a._v(" "),s("li",[a._v("-lï¼šè¾“å‡ºé”ä¿¡æ¯")]),a._v(" "),s("li",[a._v("-mï¼šå¦‚æœè°ƒç”¨åˆ°æœ¬åœ°æ–¹æ³•çš„è¯ï¼Œå¯ä»¥æ˜¾ç¤º C/C++ å †æ ˆ")])]),a._v(" "),s("p",[a._v("JDK5 ä¹‹åï¼Œjava.lang.Thread ç±»çš„ getAllStackTraces() æ–¹æ³•å¯ä»¥è·å–è™šæ‹Ÿæœºä¸­æ‰€æœ‰çº¿ç¨‹çš„StackTraceElement å¯¹è±¡ï¼Œå¯ä»¥æŸ¥çœ‹å †æ ˆä¿¡æ¯ã€‚")]),a._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Map"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("Entry")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("StackTraceElement")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" stackTrace "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getAllStackTraces")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("entrySet")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Thread")]),a._v(" thread "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" stackTrace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("StackTraceElement")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" stack "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("StackTraceElement")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" stackTrace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getValue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("equals")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("currentThread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("continue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Thread name is :"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" thread"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("StackTraceElement")]),a._v(" stackTraceElement "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" stack"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"\\t"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" stackTraceElement"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br")])]),s("p",[a._v("ç»Ÿè®¡çº¿ç¨‹æ•°ï¼šjstack -l 28367 | grep 'java.lang.Thread.State' | wc -l")]),a._v(" "),s("p",[s("strong",[a._v("jstack æ£€æµ‹ CPU è¿‡é«˜")])]),a._v(" "),s("ul",[s("li",[a._v("top æŸ¥çœ‹æ˜¯å¦ CPU å ç”¨è¿‡é«˜")]),a._v(" "),s("li",[a._v("topï¼ˆtop -H -p pidï¼‰ï¼šæŸ¥çœ‹cpuå ç”¨é«˜çº¿ç¨‹çš„ tid")]),a._v(" "),s("li",[a._v('printf "%x\\n" tidï¼Œå°†çº¿ç¨‹ ID è½¬æ¢ä¸º 16è¿›åˆ¶æ ¼å¼çš„ nid')]),a._v(" "),s("li",[a._v("jstack pid|grep nid -A 100ï¼šå®šä½cpuå ç”¨çº¿ç¨‹")])]),a._v(" "),s("p",[s("strong",[a._v("jstack è§£å†³æ­»é”")])]),a._v(" "),s("ul",[s("li",[a._v("jstack {pid} > {è¾“å‡ºæ–‡ä»¶è·¯å¾„}")]),a._v(" "),s("li",[a._v("æ‰“å¼€æ–‡ä»¶ï¼Œæ‰¾åˆ°æœ€åä¸€è¡Œï¼Œå¦‚æœæ­»é”ä¼šæœ‰æ—¥å¿—")])]),a._v(" "),s("p",[a._v("æŸ¥çœ‹æ›´å¤šä½¿ç”¨æ–¹æ³•ï¼š"),s("a",{attrs:{href:"https://docs.oracle.com/javase/8/docs/technotes/tools/windows/jstack.html#BABGJDIF",target:"_blank",rel:"noopener noreferrer"}},[a._v("Oracle jstack"),s("OutboundLink")],1)]),a._v(" "),s("h2",{attrs:{id:"è°ƒè¯•è¿›é˜¶å·¥å…·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è°ƒè¯•è¿›é˜¶å·¥å…·"}},[a._v("#")]),a._v(" è°ƒè¯•è¿›é˜¶å·¥å…·")]),a._v(" "),s("h3",{attrs:{id:"jvisualvm-å¯è§†åŒ–ç›‘æ§"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jvisualvm-å¯è§†åŒ–ç›‘æ§"}},[a._v("#")]),a._v(" JVisualVM ï¼š å¯è§†åŒ–ç›‘æ§")]),a._v(" "),s("ul",[s("li",[a._v("ç›‘æ§æœ¬åœ° Tomcat")]),a._v(" "),s("li",[a._v("ç›‘æ§è¿œç¨‹ Tomcat")]),a._v(" "),s("li",[a._v("ç›‘æ§æ™®é€šçš„ Java è¿›ç¨‹")])]),a._v(" "),s("p",[s("strong",[a._v("ç›‘æ§æœ¬åœ° Java è¿›ç¨‹")])]),a._v(" "),s("p",[a._v("jdk å·¥å…·ï¼Œå› æ­¤å­˜æ”¾åœ¨ bin ç›®å½•ï¼Œç›´æ¥åˆ°æŒ‡å®šç›®å½•ä¸Šæ‰“å¼€å³å¯ã€‚")]),a._v(" "),s("p",[a._v("ç›‘æ§ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("å¯ä»¥æ‰“å¼€ç©ç©ï¼Œå›¾åƒåŒ–ç•Œé¢ï¼Œå¯ä»¥æŸ¥çœ‹ JVM å‚æ•°ï¼Œè¿˜èƒ½å®æ—¶ç›‘æ§å†…å­˜ã€å †ã€Metaspace å ç”¨ã€ç±»è£…è½½æ€»æ•°ã€çº¿ç¨‹æ´»è·ƒæ•°ï¼Œä¹Ÿå¯ä»¥ç‚¹å‡»æ‰§è¡Œåƒåœ¾å›æ”¶ï¼Œç‚¹å‡» dump ç”Ÿæˆå †è½¬å‚¨ä¿¡æ¯ï¼Œè¿˜èƒ½ç±»ä¼¼ MAT æ¥åˆ†æç±»ã€å®ä¾‹æ•°ã€‚")]),a._v(" "),s("li",[a._v("è¿˜èƒ½å¯¼å…¥ hprof æ–‡ä»¶æ¥åˆ†æï¼Œä½†åŠŸèƒ½è¦æ¯” MAT å¼±ç‚¹ã€‚")])]),a._v(" "),s("p",[a._v("çº¿ç¨‹ï¼š\nåœ¨çº¿ç¨‹æ è¿˜å¯ä»¥ç‚¹å‡» â€œçº¿ç¨‹ Dumpâ€ï¼Œæ­¤æ—¶çœ‹åˆ°çš„å†…å®¹å’Œ jstack ä¸€æ ·çš„~")]),a._v(" "),s("p",[a._v("æŠ½æ ·å™¨ï¼šå¯ä»¥æŸ¥çœ‹æ–¹æ³•çš„å¤„ç†æ—¶é—´ï¼Œéå¸¸å¥½ç”¨")]),a._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"}),s("p",[a._v("æ”¯æŒå®‰è£…æ’ä»¶ï¼Œä¸è¿‡éœ€è¦å…ˆè®¾ç½®æ’ä»¶ä¸­å¿ƒ")]),a._v(" "),s("p",[a._v("æ¨èå®‰è£…ï¼šVisual GCï¼Œå®æ—¶åŠ¨æ€çš„æ˜¾ç¤º Eden Spaceã€Survierã€Metaspace ç­‰ç­‰")])]),s("p",[s("strong",[a._v("ç›‘æ§è¿œç¨‹ Tomcat")])]),a._v(" "),s("ol",[s("li",[a._v("æ‰“å¼€ VisualVM")]),a._v(" "),s("li",[a._v("é€‰æ‹©è¿œç¨‹ï¼Œè¾“å…¥è¿œç¨‹çš„ä¸»æœºå")]),a._v(" "),s("li",[a._v("ä¿®æ”¹ Catalina.sh")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('JAVA_OPTS="$JAVA_OPTS -Dcom.sun.management.jmxremote - Dcom.sun.management.jmxremote.port=9004 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Djava.net.preferIPv4Stack=true -Djava.rmi.server.hostname=XXX"\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ol",{attrs:{start:"4"}},[s("li",[a._v("VisualVM - è¿œç¨‹ - å³é”®ä¸»æœº - æ·»åŠ  JMX è¿æ¥ - è¿æ¥ä¸­å¡«å†™ä¸»æœºå:ç«¯å£å·")])]),a._v(" "),s("p",[s("strong",[a._v("ç›‘æ§è¿œç¨‹ java")])]),a._v(" "),s("ol",[s("li",[a._v("java å¯åŠ¨æ—¶å¸¦å…¥å‚æ•°")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("java -Dcom.sun.management.jmxremote - Dcom.sun.management.jmxremote.port=9005 -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Djava.net.preferIPv4Stack=true -Djava.rmi.server.hostname=XXX -jar {ä½ çš„ jar}\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ol",{attrs:{start:"2"}},[s("li",[a._v("VisualVM - è¿œç¨‹ - å³é”®ä¸»æœº - æ·»åŠ  JMX è¿æ¥ - è¿æ¥ä¸­å¡«å†™ä¸»æœºå:ç«¯å£å·")])]),a._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"}),s("p",[a._v("ğŸ­ äº†è§£æ›´å¤šï¼Œå¯æŸ¥çœ‹ "),s("a",{attrs:{href:"http://visualvm.github.io/documentation.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("VisualVM"),s("OutboundLink")],1),a._v("ï¼Œæœ‰ä¸­æ–‡çš„æ–‡æ¡£ï¼")])]),s("h3",{attrs:{id:"mat-åˆ†æ-oom"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mat-åˆ†æ-oom"}},[a._v("#")]),a._v(" MATï¼šåˆ†æ OOM")]),a._v(" "),s("p",[a._v("ä¸‹è½½åœ°å€ï¼šhttps://www.eclipse.org/mat/downloads.php")]),a._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"}),s("p",[a._v("æ€ä¹ˆè·å– hprof æ–‡ä»¶ï¼Œå¯å‚è€ƒ jmap ç« èŠ‚")])]),s("h3",{attrs:{id:"btrace-ç›‘æ§è°ƒè¯•å·¥å…·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#btrace-ç›‘æ§è°ƒè¯•å·¥å…·"}},[a._v("#")]),a._v(" Btraceï¼šç›‘æ§è°ƒè¯•å·¥å…·")]),a._v(" "),s("p",[a._v("ğŸ BTrace å¯ä»¥åŠ¨æ€åœ°å‘ç›®æ ‡åº”ç”¨ç¨‹åºçš„å­—èŠ‚ç æ³¨å…¥è¿½è¸ªä»£ç \nè¿ç”¨çš„æŠ€æœ¯ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("JavaComplierApi")]),a._v(" "),s("li",[a._v("JVMTI")]),a._v(" "),s("li",[a._v("Agent")]),a._v(" "),s("li",[a._v("Instrumentation+ASM")])]),a._v(" "),s("p",[a._v("å®˜æ–¹åœ°å€ï¼šhttps://github.com/btraceio/btrace")]),a._v(" "),s("p",[s("strong",[a._v("å®‰è£…")])]),a._v(" "),s("ol",[s("li",[s("a",{attrs:{href:"https://github.com/btraceio/btrace/releases/tag/v2.2.0",target:"_blank",rel:"noopener noreferrer"}},[a._v("ä¸‹è½½"),s("OutboundLink")],1),a._v("å¹¶è§£å‹")]),a._v(" "),s("li",[a._v("æ–°å»ºç¯å¢ƒå˜é‡ BTRACE_HOME")]),a._v(" "),s("li",[a._v("æ·»åŠ  PATHï¼š%BTRACE_HOME%\\bin")])]),a._v(" "),s("p",[s("strong",[a._v("è¿è¡Œæ–¹å¼")])]),a._v(" "),s("ol",[s("li",[a._v("JVisualVM ä¸­æ·»åŠ  BTrace æ’ä»¶ï¼Œæ·»åŠ  classpath")]),a._v(" "),s("li",[a._v("å‘½ä»¤è¡Œ "),s("code",[a._v("btrace <pid> <trace_script>")])])]),a._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"}),s("p",[a._v("æœ‰äº†å·«å¦–ç‹ï¼Œè¿™ä¸ªç”¨çš„äººå°‘äº†ï¼")])]),s("h3",{attrs:{id:"java-debug-tool"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-debug-tool"}},[a._v("#")]),a._v(" Java-debug-tool")]),a._v(" "),s("h3",{attrs:{id:"greys"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#greys"}},[a._v("#")]),a._v(" Greys")]),a._v(" "),s("h3",{attrs:{id:"arthas"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#arthas"}},[a._v("#")]),a._v(" Arthas")]),a._v(" "),s("h3",{attrs:{id:"jprofiler"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jprofiler"}},[a._v("#")]),a._v(" JProfiler")]),a._v(" "),s("h2",{attrs:{id:"å…¶ä»–å·¥å…·"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å…¶ä»–å·¥å…·"}},[a._v("#")]),a._v(" å…¶ä»–å·¥å…·")]),a._v(" "),s("h3",{attrs:{id:"dmesg"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dmesg"}},[a._v("#")]),a._v(" dmesg")]),a._v(" "),s("p",[a._v("å¦‚æœå‘ç°è‡ªå·±çš„javaè¿›ç¨‹æ‚„æ— å£°æ¯çš„æ¶ˆå¤±äº†ï¼Œå‡ ä¹æ²¡æœ‰ç•™ä¸‹ä»»ä½•çº¿ç´¢ï¼Œé‚£ä¹ˆdmesgä¸€å‘ï¼Œå¾ˆæœ‰å¯èƒ½æœ‰ä½ æƒ³è¦çš„ã€‚")]),a._v(" "),s("p",[a._v("sudo dmesg|grep -i kill|less å»æ‰¾å…³é”®å­—oom_killerã€‚æ‰¾åˆ°çš„ç»“æœç±»ä¼¼å¦‚ä¸‹:")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("è‘—ä½œæƒå½’https://pdai.techæ‰€æœ‰ã€‚\né“¾æ¥ï¼šhttps://pdai.tech/md/java/jvm/java-jvm-debug-tools-list.html\n\n[6710782.021013] java invoked oom-killer: gfp_mask=0xd0, order=0, oom_adj=0, oom_scoe_adj=0\n[6710782.070639] [<ffffffff81118898>] ? oom_kill_process+0x68/0x140 \n[6710782.257588] Task in /LXC011175068174 killed as a result of limit of /LXC011175068174 \n[6710784.698347] Memory cgroup out of memory: Kill process 215701 (java) score 854 or sacrifice child \n[6710784.707978] Killed process 215701, UID 679, (java) total-vm:11017300kB, anon-rss:7152432kB, file-rss:1232kB\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br")])]),s("p",[a._v("ä»¥ä¸Šè¡¨æ˜ï¼Œå¯¹åº”çš„javaè¿›ç¨‹è¢«ç³»ç»Ÿçš„OOM Killerç»™å¹²æ‰äº†ï¼Œå¾—åˆ†ä¸º854.\nè§£é‡Šä¸€ä¸‹OOM killerï¼ˆOut-Of-Memory killerï¼‰ï¼Œè¯¥æœºåˆ¶ä¼šç›‘æ§æœºå™¨çš„å†…å­˜èµ„æºæ¶ˆè€—ã€‚å½“æœºå™¨å†…å­˜è€—å°½å‰ï¼Œè¯¥æœºåˆ¶ä¼šæ‰«ææ‰€æœ‰çš„è¿›ç¨‹ï¼ˆæŒ‰ç…§ä¸€å®šè§„åˆ™è®¡ç®—ï¼Œå†…å­˜å ç”¨ï¼Œæ—¶é—´ç­‰ï¼‰ï¼ŒæŒ‘é€‰å‡ºå¾—åˆ†æœ€é«˜çš„è¿›ç¨‹ï¼Œç„¶åæ€æ­»ï¼Œä»è€Œä¿æŠ¤æœºå™¨ã€‚")]),a._v(" "),s("h2",{attrs:{id:"å‚è€ƒèµ„æ–™"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒèµ„æ–™"}},[a._v("#")]),a._v(" å‚è€ƒèµ„æ–™")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.jianshu.com/p/a4ad53179df3",target:"_blank",rel:"noopener noreferrer"}},[a._v("JVM æ€§èƒ½è°ƒä¼˜å·¥å…· jmap"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);